> https://mooseframework.inl.gov/syntax/Preconditioning/index.html

在数值求解非线性方程组时，尤其是使用 **牛顿-拉夫森法** 这种迭代方法时，常常会遇到 **收敛性** 较差的问题，特别是当初始猜测离真实解较远时。为了解决这一问题，通常会采用 **预处理** 技术（Preconditioning）来加速收敛并提高算法的稳定性。

### 为什么要进行预处理？

1. **加速收敛**：
   在使用牛顿法时，如果初始猜测离解较远，算法的收敛速度可能很慢，甚至可能发散。预处理技术通过对方程组进行变换，减少了每次迭代的误差，能够加速收敛过程。
   
2. **改善数值稳定性**：
   牛顿法的一个关键问题是雅可比矩阵$J(x)$在某些区域可能变得非常不适定，导致迭代过程的数值不稳定。预处理技术能够通过变换方程组来改善矩阵的条件数（condition number），从而提高稳定性。

3. **解决高维系统问题**：
   当处理具有多个非线性变量的系统时，雅可比矩阵可能非常稀疏且高维。直接解这种高维线性系统需要大量的计算资源。预处理可以减少系统的维度或通过简化系统来降低计算复杂度。

### 什么是预处理？

**预处理（Preconditioning）** 是在迭代法中对原始问题进行变换的过程，目的是改善问题的性质，使得数值解法在每次迭代中能更快地收敛。预处理的核心思想是，通过某种变换，得到一个更适合用迭代方法求解的线性（或非线性）系统。

在牛顿法中，预处理常常针对 **雅可比矩阵**$J(x)$进行改进。目标是通过一个 **预处理矩阵**$M$，来使得原方程组在每次迭代中变得更加容易求解。

### 如何进行预处理？

1. **对雅可比矩阵进行预处理**：
   假设原方程组是：
   $$
   J(x) \Delta x = - F(x)
   $$
   其中，$J(x)$是雅可比矩阵，$F(x)$是非线性方程组的函数值，$\Delta x$是更新量。

   通过引入一个预处理矩阵$M$，我们可以将系统变换为：
   $$
   M^{-1} J(x) \Delta x = M^{-1} (-F(x))
   $$
   这种变换后的方程组在数值解法中可能更容易求解，特别是如果$M^{-1} J(x)$的条件数较小时。

2. **选择适当的预处理矩阵$M$**：
   - **近似逆矩阵**：通常，选择一个对$J(x)$的近似逆矩阵作为预处理器。可以使用一些简单的矩阵近似，例如对角矩阵、对称矩阵等。
   - **分块矩阵**：对于复杂的非线性问题，可能会构造分块的预处理矩阵，将问题划分为更小的子问题。
   - **低秩近似**：有时，通过低秩近似（例如主成分分析）来简化雅可比矩阵，可以使得求解变得更加高效。

3. **预处理的实现方法**：
   - **Jacobi预处理**：这种方法使用矩阵的对角部分作为预处理矩阵，常用于稀疏矩阵。它的优点是计算简单，但可能不会提供最佳性能。
   - **高斯-赛德尔预处理**：采用高斯-赛德尔法对矩阵进行预处理，这种方法通常能够更好地提高收敛性。
   - **ILU预处理（不完全LU分解）**：通过对雅可比矩阵进行不完全的LU分解来构造预处理矩阵。ILU方法在处理稀疏矩阵时非常有效，能够大大加速计算过程。

   - **[Split](./预处理/Split.md)**: Field split based on preconditioner for nonlinear solver
   -  TODO


4. **内循环与外循环结合**：
   在实际应用中，预处理通常与迭代方法（如 GMRES、BiCGSTAB 等）结合使用。在每次牛顿法的迭代步骤中，可能会使用一个内循环来求解变换后的系统，从而实现有效的收敛。

### 总结

**预处理** 是一种优化手段，目的是通过改变方程组的结构来提高迭代法的效率和稳定性。在牛顿-拉夫森法中，预处理的目的是通过改进雅可比矩阵的条件数、加速迭代收敛、减小数值不稳定性以及降低计算复杂度。常见的预处理方法包括Jacobi预处理、Gauss-Seidel预处理和ILU分解等。选择合适的预处理方法依赖于问题的具体性质，包括方程的维度、矩阵的稀疏性以及初始解的质量等。